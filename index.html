<!DOCTYPE html>
<!-- Don't let GitHub put your indent mode to tabs. -->
<html lang="en-us">
    <head>
        <meta charset="UTF-8">
        <title>Experimentation</title>
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <script src="https://coolprogramminguser.github.io/Standards/behavior.js"></script>
        <script>
            var tester;
            var timer;
            var intervals = {};  // This isn't doing what I want it to do.
            var keys = {};
            var position = {left:200, top:100}; // This should be the same as the left and top values for #circle.
            var entityNumber = 1;
            var entities = [];
            var Entity = function(specs) {
                this.appearance = {"width": "2em", "height": "2em", "background": "black"};
                this.position = {"position": "absolute", "left": 30*Math.random()+"em", "top": 30*Math.random()+"em"};
                this.ID = "e" + entityNumber;
                entityNumber++;
                for (var specification in specs) {
                    switch(specification) {
                        case "appearance":
                            for (var item in specs.appearance) {
                                this.appearance[item] = specs.appearance[item];
                            }
                            break;
                        case "position":
                            for (var item in specs.position) {
                                this.position[item] = specs.position[item];
                            }
                            break;
                    }
                }
                var div = document.createElement("div");
                div.id = this.ID;
                document.body.appendChild(div);  // Actually makes the div appear.
                // Remove via div.parentNode.removeChild(div) or probably document.body.removeChild(div)
                addStyles(this.ID, this.appearance);
                addStyles(this.ID, this.position);
            }
            window.addEventListener("load", function() {  // This is what runs when the page loads; equivalent to <body onload=aFunction()>
                setTimeout(surprise, 3000);
                setTimeout(function() {clearInterval(timer);}, 12500);
                getId("design").addEventListener("click", function(click) {
                    click.preventDefault();
                    document.designMode = document.designMode=="off" ? "on" : "off";
                });
            })
            document.addEventListener("keydown", function(event) {  // This is for when a key is pressed down. This is continually called.
                if (document.designMode != "on" && checkAll(event.keyCode, "==", [37,38,39,40,32], "||")) {
                    event.preventDefault();
                }
                document.getElementById("keys").innerHTML = "The keyCode is: " + event.keyCode;
                keys[String(event.keyCode)] = true;
                if (keys["pressed"] !== true) {  // only called when nothing else is pressed
                    keys.pressed = true;
                    tester = setInterval(keyResponse, 10);
                }
            })
            document.addEventListener("keyup", function(event) {  // This is when a key is let up.
                keys[String(event.keyCode)] = false;
                if (event.keyCode == 32) {  // space bar
                    entities.push(new Entity({"appearance": {"background": hexSet([255*Math.round(Math.random()), 255*Math.round(Math.random()), 255*Math.round(Math.random())], 2, "#")}}));
                }
                var trueFalse = false;
                keys.forEach(function(value, key) {
                    if (value && key !== "pressed") {  // Is another key pressed (and is it not named pressed)?
                        trueFalse = true;
                    }
                });
                if (trueFalse !== true) {
                    keys.pressed = false;
                    clearInterval(tester);
                }
            })
            document.addEventListener("mousedown", function(event) {  // This is when the mouse is pressed.
                document.getElementById("mousePosition").innerHTML = "The mouse position is: (" + event.pageX + ", " + event.pageY + ")";
            })
            function addStyles(ID, styles) {
                styles.forEach(function(attribute, style) {
                    document.getElementById(ID).style[style] = attribute;
                });
            }
            function hexSet(numberList, digits, prefix) {  // prefix is optional
                var result = "";
                numberList.forEach(function(number) {
                    number = number.toString(16);
                    while (number.length < digits) {
                        number = "0" + number;
                    }
                    result += number;
                });
                return (prefix || "") + result;
            }
            function keyResponse() {
                keys.forEach(function(value, key) {
                    if (value == true) {
                        switch(Number(key)) {
                            case 37:  // left arrow key
                                position.left--;
                                break;
                            case 38:  // up arrow key
                                position.top--;
                                break;
                            case 39:  // right arrow key
                                position.left++;
                                break;
                            case 40:  // down arrow key
                                position.top++;
                                break;
                        }
                    }
                });
                document.getElementById("circle").style.left = position.left/10 + "em";
                document.getElementById("circle").style.top = position.top/10 + "em";
                // number + string = string; String(number) and number.toString() can convert numbers to strings.
            }
            function surprise() {
                // var timeText = document.getElementById("timer").innerHTML;  <-- doesn't work for assigning the inner HTML
                document.getElementById("timer").innerHTML = "Surprise!";
                timer=setInterval(function(){document.getElementById("timer").innerHTML=document.getElementById("timer").innerHTML+"!";}, 1000);
            }
            function doStuff() {
                if (document.getElementById("fact").innerHTML.indexOf("I am so cool.") !== -1) {
                    document.getElementById("fact").innerHTML = "I am so awesome.";
                } else {
                    document.getElementById("fact").innerHTML = "I am so cool.";
                }
            }
            function check() {
                /*
                var request = new XMLHttpRequest();
                request.open("GET", "https://coolprogramminguser.github.io/Experimentation/Text.txt");
                request.send();
                var str = request.responseText;
                document.getElementById("number").innerHTML = str.words;
                */
                // To read a text file:
                var rawFile = new XMLHttpRequest();
                rawFile.open("GET", "https://coolprogramminguser.github.io/Experimentation/Text.txt");
                rawFile.onreadystatechange = function () {
                    if(rawFile.readyState === 4) {
                        if(rawFile.status === 200 || rawFile.status == 0) {
                            var allText = rawFile.responseText;  // sets allText to a single string of the whole file
                            allText = allText.split(/\r\n|\n/);  // sets allText to an array of lines of text
                            document.getElementById("number").innerHTML = allText[1];
                        }
                    }
                }
                rawFile.send(null);  // This is necessary even though it doesn't make sense.
                /*
                // To read a JSON:
                var rawFile = new XMLHttpRequest();
                rawFile.open("GET", "https://coolprogramminguser.github.io/Experimentation/JSON.json", false);
                rawFile.onreadystatechange = function () {
                    if(rawFile.readyState === 4) {
                        if(rawFile.status === 200 || rawFile.status == 0) {
                            var allText = JSON.parse(rawFile.responseText);  // turns the string into a useable object
                            document.getElementById("number").innerHTML = allText["number"];
                        }
                    }
                }
                rawFile.send(null);
                */
            }
        </script>
        <style>
            a {
                text-decoration: none;
            }
            a:hover {
                text-decoration: underline;
            }
            footer {
                border: .1em solid yellow;
                background: #ffffcc;
                text-align: center;
            }
            #circle {
                position: absolute;
                left: 20em;
                top: 10em;
                background: red;
                width: 2em;
                height: 2em;
                border-radius: 1em;
            }
            #circle:hover {
                border-radius: 0em;
            }
            #timer {
                color: blue;
                font-size: 4em;
            }
        </style>
    </head>
    <body>
        <div id="circle">
        </div>
        <p id="fact">
            I am so cool.
        </p>
        <button onClick="doStuff()">
            Change fact
        </button>
        <p id="number">
            0
        </p>
        <button onClick="check()">
            Check
        </button>
        <br>
        <br>
        <button id="design">
            Design mode
        </button>
        <p id="keys">
            The keyCode is: 
        </p>
        <p id="mousePosition">
            The mouse position is: ( , )
        </p>
        <p id="timer">
        </p>
        <footer class="site-footer">
            <a href="https://github.com/CoolProgrammingUser/Experimentation">View on GitHub</a>
            <a href="https://github.com/CoolProgrammingUser/Experimentation/zipball/master">Download .zip</a>
            <a href="https://github.com/CoolProgrammingUser/Experimentation/tarball/master">Download .tar.gz</a>
            <p>
                <a href="https://github.com/CoolProgrammingUser/Experimentation">Experimentation</a>
                is maintained by
                <a href="https://github.com/CoolProgrammingUser" title="One awesome dude">CoolProgrammingUser</a>.
            </p>
            <p>
                This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.
            </p>
        </footer>
    </body>
</html>
